<!-- bottom-nav.component.html - CON MODAL HOME E MODAL CONTO -->
<nav class="bottom-nav d-md-none">
  <div class="nav-container" [class.container-extended]="!isLogged && (isTavoloAttivo() || isInMenuMode())">

    <!-- üè† ICONA HOME DORATA (AGGIORNATA) -->
    <div class="nav-item nav-item-home"
         [class.active]="isActiveRoute('')"
         (click)="onHomeClick()" *ngIf="!isLogged">
      <div class="home-icon-container">
        <i class="bi bi-house-fill nav-icon home-icon"></i>
      </div>
      <span class="nav-label">Home</span>
    </div>

    <!-- ===== üîê SEZIONE ADMIN (SOLO SE LOGGATA) ===== -->
    <ng-container *ngIf="isLogged">
      <!-- Dashboard Admin -->
      <div class="nav-item nav-item-admin"
           [class.active]="isActiveRoute('/dashboard')"
           (click)="navigateTo('/dashboard')">
        <i class="bi bi-speedometer2 nav-icon"></i>
        <span class="nav-label">Dashboard</span>
      </div>

      <!-- Cucina Admin -->
      <div class="nav-item nav-item-admin"
           [class.active]="isActiveRoute('/dashboard/cucina')"
           (click)="navigateTo('/dashboard/cucina')">
        <i class="bi bi-house-gear-fill nav-icon"></i>
        <span class="nav-label">Cucina</span>
      </div>

      <!-- Logout Admin -->
      <div class="nav-item nav-item-logout"
           (click)="logout()">
        <i class="bi bi-box-arrow-right nav-icon"></i>
        <span class="nav-label">Logout</span>
      </div>
    </ng-container>

    <!-- ===== üë§ SEZIONE CLIENTE (SOLO SE NON LOGGATA) ===== -->
    <ng-container *ngIf="!isLogged">

      <!-- Storico Ordini (SEMPRE VISIBILE quando in modalit√† menu o tavolo attivo) -->
      <div class="nav-item nav-item-tavolo"
           *ngIf="isTavoloAttivo() || isInMenuMode()"
           [class.active]="isActiveRoute('/storico-ordini')"
           (click)="navigateTo('/storico-ordini')">
        <div class="cart-icon-container">
          <i class="bi bi-journal-text nav-icon"></i>
          <div class="cart-badge" *ngIf="getNumeroOrdini() > 0">{{ getNumeroOrdini() }}</div>
          <div class="cart-badge cart-badge-empty" *ngIf="getNumeroOrdini() === 0">0</div>
        </div>
        <span class="nav-label">Storico</span>
      </div>

      <!-- üéØ CHIEDI CONTO CON MODAL CONFERMA (IDENTICO A SIDEBAR) -->
      <div class="nav-item nav-item-conto"
           *ngIf="(isTavoloAttivo() || isInMenuMode()) && !isContoRichiesto()"
           (click)="confermaRichiestaConto()">
        <i class="bi bi-receipt-cutoff nav-icon"></i>
        <span class="nav-label">
          <div class="conto-label">Chiedi Conto</div>
          <div class="conto-amount" *ngIf="getTotaleComplessivo() > 0">{{ getTotaleComplessivo() | currency:'EUR':'symbol':'1.2-2' }}</div>
          <div class="conto-amount conto-zero" *ngIf="getTotaleComplessivo() === 0">‚Ç¨0.00</div>
        </span>
      </div>

      <!-- Conto Richiesto (quando stato = conto_richiesto) -->
      <div class="nav-item nav-item-conto-richiesto"
           *ngIf="isContoRichiesto()">
        <i class="bi bi-check-circle-fill nav-icon"></i>
        <span class="nav-label">
          <div class="conto-label">Richiesto</div>
          <div class="conto-amount">{{ getTotaleComplessivo() | currency:'EUR':'symbol':'1.2-2' }}</div>
        </span>
      </div>

      <!-- Menu con Dropdown (sempre visibile per clienti) -->
      <div class="nav-item nav-dropdown"
           [class.active]="isActiveRoute('/menu')"
           (click)="toggleMenuDropdown()">
        <i class="bi bi-book-fill nav-icon"></i>
        <span class="nav-label">Menu</span>

        <!-- Dropdown Menu Categories -->
        <div class="menu-dropdown"
             [class.show]="showMenuDropdown">
          <div class="dropdown-grid">
            <a (click)="navigateTo('/menu/antipasti')" class="dropdown-item">
              <span class="category-emoji">ü•ü</span> Antipasti
            </a>
            <a (click)="navigateTo('/menu/zuppe')" class="dropdown-item">
              <span class="category-emoji">üçú</span> Zuppe
            </a>
            <a (click)="navigateTo('/menu/primi')" class="dropdown-item">
              <span class="category-emoji">üçù</span> Primi
            </a>
            <a (click)="navigateTo('/menu/hosomaki')" class="dropdown-item">
              <span class="category-emoji">üç£</span> Hosomaki
            </a>
            <a (click)="navigateTo('/menu/uramaki')" class="dropdown-item">
              <span class="category-emoji">üç±</span> Uramaki
            </a>
            <a (click)="navigateTo('/menu/temaki')" class="dropdown-item">
              <span class="category-emoji">üçô</span> Temaki
            </a>
            <a (click)="navigateTo('/menu/sushi')" class="dropdown-item">
              <span class="category-emoji">üçö</span> Sushi
            </a>
            <a (click)="navigateTo('/menu/secondi')" class="dropdown-item">
              <span class="category-emoji">üêü</span> Secondi
            </a>
            <a (click)="navigateTo('/menu/dolci')" class="dropdown-item">
              <span class="category-emoji">üç°</span> Dolci
            </a>
            <a (click)="navigateTo('/menu/bibite')" class="dropdown-item">
              <span class="category-emoji">üçµ</span> Bibite
            </a>
          </div>
        </div>
      </div>

      <!-- Recensioni (sempre visibile per clienti) -->
      <div class="nav-item"
           [class.active]="isActiveRoute('/reviews')"
           (click)="navigateTo('/reviews')">
        <i class="bi bi-star-fill nav-icon"></i>
        <span class="nav-label">Recensioni</span>
      </div>

      <!-- Reset Tavolo (solo se conto richiesto) -->
      <div class="nav-item nav-item-reset"
           *ngIf="isContoRichiesto()"
           (click)="resetTavolo()">
        <i class="bi bi-arrow-clockwise nav-icon"></i>
        <span class="nav-label">Reset</span>
      </div>

    </ng-container>

  </div>

  <!-- Overlay per chiudere dropdown -->
  <div class="dropdown-overlay"
       *ngIf="showMenuDropdown"
       (click)="onBackdropClick()"></div>

</nav>

<!-- üéØ MODAL HOME CONFIRMATION LUXURY -->
<div class="modal-backdrop-luxury"
     *ngIf="showHomeConfirmModal"
     [class.show]="showHomeConfirmModal">
  <div class="modal-dialog-luxury">
    <div class="modal-content-home-luxury">

      <!-- Header -->
      <div class="modal-header-home-luxury">
        <div class="header-icon-home">
          <i class="bi bi-house-exclamation-fill"></i>
        </div>
        <h4 class="modal-title-home">Tornare alla Home?</h4>
        <button type="button" class="btn-close-luxury" (click)="onCancelHome()">
          <i class="bi bi-x"></i>
        </button>
      </div>

      <!-- Body -->
      <div class="modal-body-home-luxury">
        <div class="confirm-icon-home">
          <i class="bi bi-exclamation-triangle-fill"></i>
        </div>
        <p class="confirm-message-home">Sicuro di voler abbandonare la selezione corrente?

Perderai il menu scelto e dovrai rifare l'accesso.</p>

        <!-- Info Warning -->
        <div class="warning-summary">
          <div class="warning-item" *ngIf="getNumeroOrdini() > 0">
            <span class="warning-label">Ordini effettuati:</span>
            <span class="warning-value">{{ getNumeroOrdini() }}</span>
          </div>
          <div class="warning-item" *ngIf="getTotaleComplessivo() > 0">
            <span class="warning-label">Totale speso:</span>
            <span class="warning-value">{{ getTotaleComplessivo() | currency:'EUR' }}</span>
          </div>
          <div class="warning-item">
            <span class="warning-label">Stato:</span>
            <span class="warning-value" *ngIf="!isContoRichiesto()">Menu attivo</span>
            <span class="warning-value" *ngIf="isContoRichiesto()">Conto richiesto</span>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div class="modal-footer-home-luxury">
        <button type="button"
                class="btn-stay-luxury"
                (click)="onCancelHome()">
          <i class="bi bi-arrow-left me-2"></i>
          Rimani qui
        </button>
        <button type="button"
                class="btn-home-luxury"
                (click)="onConfirmHome()">
          <i class="bi bi-house-fill me-2"></i>
          Vai alla Home
        </button>
      </div>
    </div>
  </div>
</div>

<!-- üéØ MODAL CONFERMA CONTO LUXURY (IDENTICO A SIDEBAR) -->
<div class="modal-backdrop-luxury"
     *ngIf="showContoConfirmModal"
     [class.show]="showContoConfirmModal">
  <div class="modal-dialog-luxury">
    <div class="modal-content-conto-luxury">

      <!-- Header -->
      <div class="modal-header-conto-luxury">
        <div class="header-icon-conto">
          <i class="bi bi-receipt-cutoff"></i>
        </div>
        <h4 class="modal-title-conto">Richiedi il Conto</h4>
        <button type="button" class="btn-close-luxury" (click)="onCancelConto()">
          <i class="bi bi-x"></i>
        </button>
      </div>

      <!-- Body -->
      <div class="modal-body-conto-luxury">
        <div class="confirm-icon-conto">
          <i class="bi bi-question-circle-fill"></i>
        </div>
        <p class="confirm-message-conto">Sicuro di voler richiedere il conto di {{ getTotaleComplessivo() | currency:'EUR' }}?

Non sar√† possibile aggiungere altri ordini dopo.</p>

        <!-- Info Summary -->
        <div class="conto-summary">
          <div class="summary-item" *ngIf="getNumeroOrdini() > 0">
            <span class="summary-label">Ordini:</span>
            <span class="summary-value">{{ getNumeroOrdini() }}</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Totale:</span>
            <span class="summary-value">{{ getTotaleComplessivo() | currency:'EUR' }}</span>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div class="modal-footer-conto-luxury">
        <button type="button"
                class="btn-cancel-luxury"
                (click)="onCancelConto()">
          <i class="bi bi-x-circle me-2"></i>
          Annulla
        </button>
        <button type="button"
                class="btn-confirm-luxury"
                (click)="onConfirmConto()">
          <i class="bi bi-check-circle me-2"></i>
          Richiedi Conto
        </button>
      </div>
    </div>
  </div>
</div>
