<!-- bottom-nav.component.html - CON LOGICA TAVOLO -->
<nav class="bottom-nav d-md-none">
  <div class="nav-container" [class.container-extended]="isTavoloAttivo()">

    <!-- üÜï STORICO ORDINI (priorit√† se tavolo attivo) -->
    <div class="nav-item nav-item-tavolo"
         *ngIf="isTavoloAttivo()"
         [class.active]="isActiveRoute('/storico-ordini')"
         (click)="navigateTo('/storico-ordini')">
      <div class="cart-icon-container">
        <i class="bi bi-journal-text nav-icon"></i>
        <div class="cart-badge">{{ getNumeroOrdini() }}</div>
      </div>
      <span class="nav-label">Storico</span>
    </div>

    <!-- üÜï CHIEDI CONTO (se tavolo attivo e conto non richiesto) -->
    <div class="nav-item nav-item-conto"
         *ngIf="isTavoloAttivo() && !isContoRichiesto()"
         (click)="richiediConto()">
      <i class="bi bi-receipt-cutoff nav-icon"></i>
      <span class="nav-label">
        <div class="conto-label">Conto</div>
        <div class="conto-amount">{{ getTotaleComplessivo() | currency:'EUR':'symbol':'1.0-0' }}</div>
      </span>
    </div>

    <!-- üÜï CONTO RICHIESTO -->
    <div class="nav-item nav-item-conto-richiesto"
         *ngIf="isContoRichiesto()">
      <i class="bi bi-check-circle-fill nav-icon"></i>
      <span class="nav-label">
        <div class="conto-label">Richiesto</div>
        <div class="conto-amount">{{ getTotaleComplessivo() | currency:'EUR':'symbol':'1.0-0' }}</div>
      </span>
    </div>

    <!-- Home (solo se NO tavolo attivo o sempre visibile)
    <div class="nav-item"
         *ngIf="!isTavoloAttivo()"
         [class.active]="isActiveRoute('') && getCurrentRoute() === '/'"
         (click)="navigateTo('')">
      <i class="bi bi-house-fill nav-icon"></i>
      <span class="nav-label">Home</span>
    </div>-->

    <!-- Menu con Dropdown (sempre visibile) -->
    <div class="nav-item nav-dropdown"
         [class.active]="isActiveRoute('/menu')"
         (click)="toggleMenuDropdown()">
      <i class="bi bi-book-fill nav-icon"></i>
      <span class="nav-label">Menu</span>

      <!-- Dropdown Menu Categories -->
      <div class="menu-dropdown"
           [class.show]="showMenuDropdown"
           [class.ms-5]="isLogged">
        <div class="dropdown-grid">
          <a (click)="navigateTo('/menu/antipasti')" class="dropdown-item" style="border:1px solid #d4af37;">
            <span class="category-emoji">ü•ü</span> Antipasti
          </a>
          <a (click)="navigateTo('/menu/zuppe')" class="dropdown-item" style="border:1px solid #d4af37;">
            <span class="category-emoji">üçú</span> Zuppe
          </a>
          <a (click)="navigateTo('/menu/primi')" class="dropdown-item" style="border:1px solid #d4af37;">
            <span class="category-emoji">üçù</span> Primi
          </a>
          <a (click)="navigateTo('/menu/hosomaki')" class="dropdown-item" style="border:1px solid #d4af37;">
            <span class="category-emoji">üç£</span> Hosomaki
          </a>
          <a (click)="navigateTo('/menu/uramaki')" class="dropdown-item" style="border:1px solid #d4af37;">
            <span class="category-emoji">üç±</span> Uramaki
          </a>
          <a (click)="navigateTo('/menu/temaki')" class="dropdown-item" style="border:1px solid #d4af37;">
            <span class="category-emoji">üçô</span> Temaki
          </a>
          <a (click)="navigateTo('/menu/sushi')" class="dropdown-item" style="border:1px solid #d4af37;">
            <span class="category-emoji">üçö</span> Sushi
          </a>
          <a (click)="navigateTo('/menu/secondi')" class="dropdown-item" style="border:1px solid #d4af37;">
            <span class="category-emoji">üêü</span> Secondi
          </a>
          <a (click)="navigateTo('/menu/dolci')" class="dropdown-item" style="border:1px solid #d4af37;">
            <span class="category-emoji">üç°</span> Dolci
          </a>
          <a (click)="navigateTo('/menu/bibite')" class="dropdown-item" style="border:1px solid #d4af37;">
            <span class="category-emoji">üçµ</span> Bibite
          </a>
        </div>
      </div>
    </div>

    <!-- Cucina (solo se loggato e NO tavolo attivo) -->
    <div class="nav-item"
         *ngIf="isLogged && !isTavoloAttivo()"
         [class.active]="isActiveRoute('/dashboard/cucina')"
         (click)="navigateTo('/dashboard/cucina')">
      <i class="bi bi-house-gear-fill nav-icon"></i>
      <span class="nav-label">Cucina</span>
    </div>

    <!-- Account/Dashboard (solo se NO tavolo attivo) -->
    <div class="nav-item"
         *ngIf="!isTavoloAttivo()"
         [class.active]="isActiveRoute('/dashboard') || isActiveRoute('/auth')"
         (click)="navigateTo(isLogged ? '/dashboard' : '/auth')">
      <i class="bi nav-icon"
         [class.bi-person-gear]="isLogged"
         [class.bi-person-fill]="!isLogged"></i>
      <span class="nav-label">{{ isLogged ? 'Dashboard' : 'Accedi' }}</span>
    </div>

    <!-- üÜï RESET TAVOLO (solo se conto richiesto) -->
    <div class="nav-item nav-item-reset"
         *ngIf="isContoRichiesto()"
         (click)="resetTavolo()">
      <i class="bi bi-arrow-clockwise nav-icon"></i>
      <span class="nav-label">Reset</span>
    </div>

    <!-- LOGOUT (solo se loggato e NO tavolo attivo) -->
    <div class="nav-item logout-item"
         *ngIf="isLogged && !isTavoloAttivo()"
         (click)="logout()">
      <i class="bi bi-box-arrow-right nav-icon"></i>
      <span class="nav-label">Logout</span>
    </div>

  </div>

  <!-- üÜï BADGE STATO TAVOLO FLOTTANTE -->
  <div *ngIf="isTavoloAttivo()" class="tavolo-status-floating">
    <div class="status-content">
      <div class="status-icon">
        <i class="bi" [class.bi-reception-4]="!isContoRichiesto()" [class.bi-check-circle-fill]="isContoRichiesto()"></i>
      </div>
      <div class="status-text">
        <div class="status-label">{{ isContoRichiesto() ? 'Conto Finale' : 'Totale' }}</div>
        <div class="status-total">{{ getTotaleComplessivo() | currency:'EUR':'symbol':'1.0-0' }}</div>
      </div>
    </div>
  </div>

  <!-- Overlay per chiudere dropdown -->
  <div class="dropdown-overlay"
       *ngIf="showMenuDropdown"
       (click)="onBackdropClick()"></div>
</nav>
