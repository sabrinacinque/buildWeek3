<div class="sidebar-luxury vh-100" id="sidebar-wrapper">
  <!-- Header Logo Section -->
  <div class="sidebar-header-luxury">
    <div class="logo-section-luxury" (click)="onHomeClick()">
      <h2 class="brand-title-sidebar">
        <span class="brand-epi">EPI</span><span class="brand-sushi">SUSHI</span>
      </h2>
      <div class="logo-divider-sidebar"></div>

      <!-- üÜï BADGE STATO TAVOLO - SOLO SE NON LOGGATA -->
      <div *ngIf="!isLogged && (tavoloState$ | async) as tavolo" class="tavolo-status-badge">
        <div *ngIf="tavolo.statoTavolo === 'conto_richiesto'" class="status-conto">
          <i class="bi bi-receipt-cutoff"></i>
          <span>Conto Finale</span>
          <div class="total-badge">{{ tavolo.totaleComplessivo | currency:'EUR' }}</div>
        </div>
      </div>
    </div>

    <!-- Logout Button - SOLO SE LOGGATA -->
    <div *ngIf="isLogged" class="logout-section-luxury" (click)="logout()">
      <div class="logout-button-luxury" title="Logout">
        <i class="bi bi-box-arrow-right"></i>
      </div>
    </div>
  </div>

  <!-- Navigation Menu -->
  <div class="navigation-luxury">
    <nav class="nav-list-luxury">

      <!-- ===== üîê SEZIONE ADMIN (SOLO SE LOGGATA) ===== -->
      <ng-container *ngIf="isLogged">
        <!-- Dashboard Admin -->
        <a routerLink="/dashboard"
           routerLinkActive="active"
           class="nav-item-luxury nav-item-special">
          <div class="nav-content">
            <i class="bi bi-speedometer2 nav-icon"></i>
            <span class="nav-text">Dashboard</span>
            <span class="admin-badge">ADMIN</span>
          </div>
          <div class="nav-glow"></div>
        </a>

        <!-- Cucina Admin -->
        <a routerLink="/dashboard/cucina"
           routerLinkActive="active"
           class="nav-item-luxury nav-item-special">
          <div class="nav-content">
            <i class="bi bi-house-gear-fill nav-icon"></i>
            <span class="nav-text">Cucina</span>
            <span class="admin-badge">ADMIN</span>
          </div>
          <div class="nav-glow"></div>
        </a>
      </ng-container>

      <!-- ===== üë§ SEZIONE CLIENTE (SOLO SE NON LOGGATA) ===== -->
      <ng-container *ngIf="!isLogged">
        <!-- Storico Ordini (solo se tavolo attivo) -->
        <a *ngIf="isTavoloAttivo()"
           routerLink="/storico-ordini"
           routerLinkActive="active"
           class="nav-item-luxury nav-item-tavolo">
          <div class="nav-content">
            <i class="bi bi-journal-text nav-icon"></i>
            <span class="nav-text">Storico Ordini</span>
            <span class="ordini-badge">{{ getNumeroOrdini() }}</span>
          </div>
          <div class="nav-glow"></div>
        </a>

        <!-- üéØ CHIEDI CONTO CON MODAL CONFERMA -->
        <a *ngIf="isTavoloAttivo() && !isContoRichiesto()"
           (click)="confermaRichiestaConto()"
           class="nav-item-luxury nav-item-conto">
          <div class="nav-content">
            <i class="bi bi-receipt-cutoff nav-icon"></i>
            <span class="nav-text">Chiedi il Conto</span>
            <div class="conto-total">{{ getTotaleComplessivo() | currency:'EUR' }}</div>
          </div>
          <div class="nav-glow"></div>
        </a>

        <!-- Conto Richiesto (quando stato = conto_richiesto) -->
        <div *ngIf="isContoRichiesto()"
             class="nav-item-luxury nav-item-conto-richiesto">
          <div class="nav-content">
            <i class="bi bi-check-circle-fill nav-icon"></i>
            <span class="nav-text">Conto Richiesto</span>
            <div class="conto-total">{{ getTotaleComplessivo() | currency:'EUR' }}</div>
          </div>
          <div class="nav-glow"></div>
        </div>

        <!-- Divider (solo se tavolo attivo) -->
        <div *ngIf="isTavoloAttivo()" class="nav-divider-luxury"></div>

        <!-- Menu Categories -->
        <a routerLink="/menu/antipasti"
           routerLinkActive="active"
           class="nav-item-luxury">
          <div class="nav-content">
            <span class="nav-emoji">ü•ü</span>
            <span class="nav-text">Antipasti</span>
          </div>
          <div class="nav-glow"></div>
        </a>

        <a routerLink="/menu/zuppe"
           routerLinkActive="active"
           class="nav-item-luxury">
          <div class="nav-content">
            <span class="nav-emoji">üçú</span>
            <span class="nav-text">Zuppe</span>
          </div>
          <div class="nav-glow"></div>
        </a>

        <a routerLink="/menu/primi"
           routerLinkActive="active"
           class="nav-item-luxury">
          <div class="nav-content">
            <span class="nav-emoji">üçù</span>
            <span class="nav-text">Primi</span>
          </div>
          <div class="nav-glow"></div>
        </a>

        <a routerLink="/menu/hosomaki"
           routerLinkActive="active"
           class="nav-item-luxury">
          <div class="nav-content">
            <span class="nav-emoji">üç£</span>
            <span class="nav-text">Hosomaki</span>
          </div>
          <div class="nav-glow"></div>
        </a>

        <a routerLink="/menu/uramaki"
           routerLinkActive="active"
           class="nav-item-luxury">
          <div class="nav-content">
            <span class="nav-emoji">üç±</span>
            <span class="nav-text">Uramaki</span>
          </div>
          <div class="nav-glow"></div>
        </a>

        <a routerLink="/menu/temaki"
           routerLinkActive="active"
           class="nav-item-luxury">
          <div class="nav-content">
            <span class="nav-emoji">üçô</span>
            <span class="nav-text">Temaki</span>
          </div>
          <div class="nav-glow"></div>
        </a>

        <a routerLink="/menu/sushi"
           routerLinkActive="active"
           class="nav-item-luxury">
          <div class="nav-content">
            <span class="nav-emoji">üçö</span>
            <span class="nav-text">Sushi</span>
          </div>
          <div class="nav-glow"></div>
        </a>

        <a routerLink="/menu/secondi"
           routerLinkActive="active"
           class="nav-item-luxury">
          <div class="nav-content">
            <span class="nav-emoji">üêü</span>
            <span class="nav-text">Secondi</span>
          </div>
          <div class="nav-glow"></div>
        </a>

        <a routerLink="/menu/dolci"
           routerLinkActive="active"
           class="nav-item-luxury">
          <div class="nav-content">
            <span class="nav-emoji">üç°</span>
            <span class="nav-text">Dolci</span>
          </div>
          <div class="nav-glow"></div>
        </a>

        <a routerLink="/menu/bibite"
           routerLinkActive="active"
           class="nav-item-luxury">
          <div class="nav-content">
            <span class="nav-emoji">üçµ</span>
            <span class="nav-text">Bibite</span>
          </div>
          <div class="nav-glow"></div>
        </a>

        <!-- Divider -->
        <div class="nav-divider-luxury"></div>

        <!-- Recensioni -->
        <a routerLink="/reviews"
           routerLinkActive="active"
           class="nav-item-luxury">
          <div class="nav-content">
            <i class="bi bi-star-fill nav-icon"></i>
            <span class="nav-text">Recensioni</span>
          </div>
          <div class="nav-glow"></div>
        </a>
      </ng-container>

    </nav>
  </div>

  <!-- Footer with decorative elements -->
  <div class="sidebar-footer-luxury">
    <!-- Reset Tavolo (solo se conto richiesto E non loggata) -->
    <div *ngIf="!isLogged && isContoRichiesto()" class="reset-tavolo-section">
      <button class="btn-reset-tavolo" (click)="resetTavolo()">
        <i class="bi bi-arrow-clockwise"></i>
        <span>Nuovo Tavolo</span>
      </button>
    </div>

    <div class="footer-decoration">
      <div class="decoration-line"></div>
      <div class="decoration-center">‚ú®</div>
      <div class="decoration-line"></div>
    </div>
  </div>
</div>

<!-- üéØ MODAL HOME CONFIRMATION LUXURY -->
<div class="modal-backdrop-luxury"
     *ngIf="showHomeConfirmModal"
     [class.show]="showHomeConfirmModal">
  <div class="modal-dialog-luxury">
    <div class="modal-content-home-luxury">

      <!-- Header -->
      <div class="modal-header-home-luxury">
        <div class="header-icon-home">
          <i class="bi bi-house-exclamation-fill"></i>
        </div>
        <h4 class="modal-title-home">Tornare alla Home?</h4>
        <button type="button" class="btn-close-luxury" (click)="onCancelHome()">
          <i class="bi bi-x"></i>
        </button>
      </div>

      <!-- Body -->
      <div class="modal-body-home-luxury">
        <div class="confirm-icon-home">
          <i class="bi bi-exclamation-triangle-fill"></i>
        </div>
        <p class="confirm-message-home">Sicuro di voler abbandonare la selezione corrente?

Perderai il menu scelto e dovrai rifare l'accesso.</p>

        <!-- Info Warning -->
        <div class="warning-summary">
          <div class="warning-item" *ngIf="getNumeroOrdini() > 0">
            <span class="warning-label">Ordini effettuati:</span>
            <span class="warning-value">{{ getNumeroOrdini() }}</span>
          </div>
          <div class="warning-item" *ngIf="getTotaleComplessivo() > 0">
            <span class="warning-label">Totale speso:</span>
            <span class="warning-value">{{ getTotaleComplessivo() | currency:'EUR' }}</span>
          </div>
          <div class="warning-item">
            <span class="warning-label">Stato:</span>
            <span class="warning-value" *ngIf="!isContoRichiesto()">Menu attivo</span>
            <span class="warning-value" *ngIf="isContoRichiesto()">Conto richiesto</span>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div class="modal-footer-home-luxury">
        <button type="button"
                class="btn-stay-luxury"
                (click)="onCancelHome()">
          <i class="bi bi-arrow-left me-2"></i>
          Rimani qui
        </button>
        <button type="button"
                class="btn-home-luxury"
                (click)="onConfirmHome()">
          <i class="bi bi-house-fill me-2"></i>
          Vai alla Home
        </button>
      </div>
    </div>
  </div>
</div>

<!-- üéØ MODAL CONFERMA CONTO LUXURY -->
<div class="modal-backdrop-luxury"
     *ngIf="showContoConfirmModal"
     [class.show]="showContoConfirmModal">
  <div class="modal-dialog-luxury">
    <div class="modal-content-conto-luxury">

      <!-- Header -->
      <div class="modal-header-conto-luxury">
        <div class="header-icon-conto">
          <i class="bi bi-receipt-cutoff"></i>
        </div>
        <h4 class="modal-title-conto">Richiedi il Conto</h4>
        <button type="button" class="btn-close-luxury" (click)="onCancelConto()">
          <i class="bi bi-x"></i>
        </button>
      </div>

      <!-- Body -->
      <div class="modal-body-conto-luxury">
        <div class="confirm-icon-conto">
          <i class="bi bi-question-circle-fill"></i>
        </div>
        <p class="confirm-message-conto">Sicuro di voler richiedere il conto di {{ getTotaleComplessivo() | currency:'EUR' }}?

Non sar√† possibile aggiungere altri ordini dopo.</p>

        <!-- Info Summary -->
        <div class="conto-summary">
          <div class="summary-item" *ngIf="getNumeroOrdini() > 0">
            <span class="summary-label">Ordini:</span>
            <span class="summary-value">{{ getNumeroOrdini() }}</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Totale:</span>
            <span class="summary-value">{{ getTotaleComplessivo() | currency:'EUR' }}</span>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div class="modal-footer-conto-luxury">
        <button type="button"
                class="btn-cancel-luxury"
                (click)="onCancelConto()">
          <i class="bi bi-x-circle me-2"></i>
          Annulla
        </button>
        <button type="button"
                class="btn-confirm-luxury"
                (click)="onConfirmConto()">
          <i class="bi bi-check-circle me-2"></i>
          Richiedi Conto
        </button>
      </div>
    </div>
  </div>
</div>